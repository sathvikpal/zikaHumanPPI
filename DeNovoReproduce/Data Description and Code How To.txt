Contents:
-------------------------------------------
I-	 How To Reproduce the Study?
II-  Data Files Description
III- Code Files Description



-------------------------------------------
I-How To Reproduce the Study?
-------------------------------------------
1. Negative Sampling Preparation: 
	Run Dissimilarity_Distance.m
2. Feature Extraction: 
	Run Features_Criterion1.m for criterion 1 partitioning
	Run Features_Criterion2.m for criterion 2 partitioning.
3. SVM model:
	If you are using 64-bit Linux, skip this step; 
	otherwise:
			Install LibSVM for Matlab on your machine to be able to run the cross validation and testing. 
			Rename the train and predict mexa files as svmtrainX and svmpredict.
			Make sure these two files are located in the same folder of the study code. 
4. Cross validation: 
	Run CrossValidation.m
5. Testing Criterion 1: 
	Run Testing_Criterion1.m
6. Testing Criterion 2: 
	Run Testing_Criterion2.m

	
	
-------------------------------------------
II-  Data Files Description
-------------------------------------------
Mentha_All_Vs.mat: 
**********************************************
- Interactions main data file.
- (GeneA, GeneB, ProteinA, ProteinB, SubfamilyA, SubfamilyB, TaxonA, TaxonB, Score, PMID): Cleaned interaction identifiers, A is for human, B for virus. 
- (ProteinA_Unique,ProteinB_Unique): Human and viral proteins in the study. Order is held for indexing
- (Sub_Unique,Tax_Unique): Viral subfamilies and taxons. Order is held for indexing
- (VirusID_Maper): Indexing the viral taxons in the study, those in (TaxonB)
- (Mapper_Vp_Tax_Sub): For each viral protein index in column 1, column 2 and 3 are its viral and subfamily taxons repsectively.        
- (Interactions_Table_2): Interactions with proteins indexed [Human protein index| Viral protein index | Virus taxon | Viral subfamily taxon]
- (Interactions_Table): Interactions with proteins indexed [Human protein index| Viral protein index | Virus taxon]

All_Viral_interacting.fasta: 
****************************
- Sequences of all viral proteins in the study, the order matches that of (ProteinB_Unique) in Mentha_All_Vs.mat

FastaSeqData.mat: 
*****************
- Sequence of human and viral proteins used in the study
- (H_Hdr, V_Hdr): Headers of the human and viral proteins in order
- (H_Seq, V_Seq): Sequence of the human and viral proteins in the study, as indexed in (ProteinA_Unique,ProteinB_Unique) in Mentha_All_Vs.mat.

ParIndex.mat:
*****************
- Different lists of parameter values for the SVMs. 
- Paramter list ParIndexCG2 is the one used in the study. The first entry is a C value and the second is a Gamma value.

svmtrainX.mexa64 and svmpredict.mexa64
*************************
- Training and testing functions for the SVM models implemented in LibSVM.
- Works only for 64-bit Linux environment. You need to install LibSVM for Matlab and rename the train and predict mexa files as the above names. 



-------------------------------------------
III-  Code Files Description
-------------------------------------------
Dissimilarity_Distance.m:
*************************
- Implementation of the first part of the Dissimilarity-Random-Sampling algorithm; the random selection and thresholding are implemented in the feature extraction files: Features_Criterion1.m and Features_Criterion2.m
- OUTPUT:Distance30.mat with BLOSUM30 used in the all-vs-all alignments and the outliers removed.

Features_Criterion1.m:
*************************
- Partitioning  (Criterion 1) - Negative Sampling - Feature extraction
- OUTPUT: For each output file, 49 feature vector sets, each of which represents interactions (+ and -) that meet partitioning criterion 1. 
- Accessory Functions:
	- FeatureExtraction_Mentha_SVM_ByVp.m
	- Negative_Sampling_CutRandom333.m
	- Negative_Sampling_Proportional.m

Features_Criterion2.m:
*************************
- Partitioning  (Criterion 2) - Negative Sampling - Feature extraction
- OUTPUT: For each output file, 10 feature vector sets, each of which represents interactions (+ and -) that meet partitioning criterion 2.
- Accessory Functions:
	- FeatureExtraction_Mentha_SVM_ByVp.m
	- Negative_Sampling_CutRandom333.m
	- Negative_Sampling_Proportional.m
	
Testing_Criterion1.m
*************************
- Trains a SVM model with the paramter values specified for C and Gamma (at the top of the file) over different values of the negative sampling dissimilarity cutoff T=[0:0.1:0.9].
- Current parameter values are the optimal ones C* and Gamma*. You can change these values or add a list of (C,Gamma) values to the variable CGs. For each row in CGs, the first entry is some C value, and the second entry is a Gamma value. 
- Tests the model on a leave-one-out bases, for each of the 49 subsets generated by the partitioning criterion 1, all the subset except the ith are used to train the model, while the ith subset is used for testing. 
- Accuracy measures are averaged over the 49 subset testing weighted by each subset size. 
- OUTPUT:  One file for each value for T whose name specified by the variable ResultFile.
In each file:
	 FeatureFile: 	The name of the feature vector file used in training and testing the model 
	 ParVect_cell:  The paramter vector as fed into the LIBSVM SVM model.
	 Stat_Ts_cell:  The ith cell carries a 49X5 matrix of statisitcs from TESTING the model in the 49 rounds. 
					Entries: (Accuracy,Sensitivity,Specificity,MCC,Trainng set size)
     Stat_Tr_cell:  The ith cell carries a 49X6 matrix of statisitcs from TRAINING the model in the 49 rounds. 
					Entries: (Accuracy,Sensitivity,Specificity,MCC,Trainng set size,Support vector ratio)
	 Averages_cell: Each row carries averages of the statisticsin the ith cell in Stat_Ts_cell
					Entries: (Weighted average accuracy, Weighted average sensitivity, Average sensitivity, Weighted average specificity, Average specificity, Average accuracy, Weighted average support vector ratio)  
	 endtime_cell: 	The ith cell corresponds to the time it takes the model to train and test all the subsets for the ith (C,Gamma) pair. 
	 

Testing_Criterion2.m
*************************
- Similar to [Testing_Criterion1.m] but with the 10 subsets from the family partitioning (Criterion 2) instead of the 49 ones. 


CrossValidation.m
*************************
- Runs k-fold cross-validation (default k=5) over the entire data set interactions (+ and -) over T range [0:0.1:0.9] and different parameter values for C and Gamma.
OUTPUT: One file for each value for T whose name specified by the varilable ResultFile.
In each file:
	CGs: 			List of (C,Gamma) values used in the cross-validation (CV)
	CVTime:   		Time taken in the CV round
	Acc_CV:   		CV accuracy for each pair of (C,Gamma) in ParIndex
	FeatureFile:	The feature file used in the CV
	Kfolds: 		Default number of k in the CV